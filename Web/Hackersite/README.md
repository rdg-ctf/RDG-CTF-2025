# Hackersite

## Описание:


| Название | Сложность | Автор |
|------|--------|--------|
| Hackesite | Medium |[@MrNansy](https://t.me/MrNansy) |

## TLDR

CMDi via **Newline injection**  

---
## Решение:

## 1. Лендинг

На лендинге видим главную страницу с функционалом регистрации и авторизации:  

![Главная страница](img_for_readme/10.png)

Проходим эту процедуру

После авторизации обращаемся к эндпоинту `/markdown`, где можем конвертировать markdown в html

![markdown](img_for_readme/17.png)
 
Базовые проверки позволят нам вызвать ошибку и получть информацию о выполняемом пайплайне: `echo "<input>" | pandoc ...`

![Вызов ошибки (часть 1)](img_for_readme/18.png)

Все сводится к CMD-инъекции, осталось понять, как ее выполнить. Подбирая нагрузку для CMDi в таком пайплайне, можно попробовать выполнить инъекцию newline-символа: `"%0a\"` – она не вызывает ошибок, но и вывода не возвращает

![Эксперимент](img_for_readme/22.png)

Далее попробуем выполнить инъекцию команды после newline – `"%0als%0a\"`

![Получаем вывод директории ls](img_for_readme/23.png)

Успешная инъекция связана с тем, что `%0a` позволяет «разорвать» команду. Shell воспринимает это как:
  ```bash
  echo "..."
  ls
  echo "..."
  | pandoc ...
  ```

Остается лишь найти flag.txt в `/tmp`: `%0als+/tmp%0a\`

![Получаем вывод директории ls /tmp](img_for_readme/24.png)

Попытка прочитать файл через `cat` даст понять, что `cat` фильтруется: 

![пытаемся сделать cat/tmp/flag.txt](img_for_readme/26.png)

Можем воспользоваться, например, `head`:

![пытаемся сделать head/tmp/flag.txt](img_for_readme/27.png)

## Flag:
rdg{n3wl1n3_m4y_l34d_t0_rc3}
